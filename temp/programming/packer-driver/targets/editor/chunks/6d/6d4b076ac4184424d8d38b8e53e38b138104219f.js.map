{"version":3,"sources":["file:///D:/project/claudecode/wx/Cat_Journey/assets/scripts/core/CameraVisibilityAnalyzer.ts"],"names":["_decorator","Component","ccclass","property","CameraVisibilityAnalyzer","onLoad","analyzeCameraVisibility","cameraVisibility","console","log","toString","commonLayers","name","value","Object","entries","isVisible","backgroundLayer","canRenderBackground"],"mappings":";;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;;;;;;;;OACf;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;;0CAGjBI,wB,WADZF,OAAO,CAAC,0BAAD,C,gBAAR,MACaE,wBADb,SAC8CH,SAD9C,CACwD;AAC1CI,QAAAA,MAAM,GAAS;AACrB,eAAKC,uBAAL;AACH;;AAEOA,QAAAA,uBAAuB,GAAS;AACpC;AACA,gBAAMC,gBAAgB,GAAG,QAAzB;AAEAC,UAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAa,qBAAoBF,gBAAiB,EAAlD;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAa,UAASF,gBAAgB,CAACG,QAAjB,CAA0B,CAA1B,CAA6B,EAAnD,EANoC,CAQpC;;AACA,gBAAMC,YAAY,GAAG;AACjB,uBAAW,CADM;AAEjB,qBAAS,QAFQ;AAEO;AACxB,qBAAS,QAHQ;AAIjB,2BAAe,UAJE;AAKjB,sBAAU;AALO,WAArB;AAQAH,UAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;;AACA,eAAK,MAAM,CAACG,IAAD,EAAOC,KAAP,CAAX,IAA4BC,MAAM,CAACC,OAAP,CAAeJ,YAAf,CAA5B,EAA0D;AACtD,kBAAMK,SAAS,GAAG,CAACT,gBAAgB,GAAGM,KAApB,MAA+B,CAAjD;AACAL,YAAAA,OAAO,CAACC,GAAR,CAAa,GAAEG,IAAK,KAAIC,KAAM,MAAKG,SAAS,GAAG,MAAH,GAAY,OAAQ,EAAhE;AACH,WArBmC,CAuBpC;;;AACA,gBAAMC,eAAe,GAAG,CAAxB;AACA,gBAAMC,mBAAmB,GAAG,CAACX,gBAAgB,GAAGU,eAApB,MAAyC,CAArE;AACAT,UAAAA,OAAO,CAACC,GAAR,CAAa,gBAAb;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAa,yBAAwBS,mBAAmB,GAAG,QAAH,GAAc,QAAS,EAA/E,EA3BoC,CA6BpC;;AACAV,UAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACAD,UAAAA,OAAO,CAACC,GAAR,CAAa,uBAAsBF,gBAAgB,GAAGU,eAAgB,EAAtE;AACH;;AAvCmD,O","sourcesContent":["import { _decorator, Component, Camera, Layers } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CameraVisibilityAnalyzer')\r\nexport class CameraVisibilityAnalyzer extends Component {\r\n    protected onLoad(): void {\r\n        this.analyzeCameraVisibility();\r\n    }\r\n    \r\n    private analyzeCameraVisibility(): void {\r\n        // 从场景文件中看到的摄像机可见性值\r\n        const cameraVisibility = 41943040;\r\n        \r\n        console.log('=== 摄像机渲染Layer分析 ===');\r\n        console.log(`摄像机 Visibility 值: ${cameraVisibility}`);\r\n        console.log(`二进制表示: ${cameraVisibility.toString(2)}`);\r\n        \r\n        // 常见Layer值分析\r\n        const commonLayers = {\r\n            'DEFAULT': 1,\r\n            'UI_2D': 33554432,      // 这是Canvas默认Layer\r\n            'UI_3D': 67108864,\r\n            'SCENE_GIZMO': 1073741824,\r\n            'EDITOR': 2147483648,\r\n        };\r\n        \r\n        console.log('\\n--- Layer匹配检测 ---');\r\n        for (const [name, value] of Object.entries(commonLayers)) {\r\n            const isVisible = (cameraVisibility & value) !== 0;\r\n            console.log(`${name} (${value}): ${isVisible ? '✅ 可见' : '❌ 不可见'}`);\r\n        }\r\n        \r\n        // BackgroundLayer使用的Layer 1分析\r\n        const backgroundLayer = 1;\r\n        const canRenderBackground = (cameraVisibility & backgroundLayer) !== 0;\r\n        console.log(`\\n--- 关键发现 ---`);\r\n        console.log(`Background Layer (1): ${canRenderBackground ? '✅ 可以渲染' : '❌ 不能渲染'}`);\r\n        \r\n        // 建议的修复方法\r\n        console.log('\\n--- 修复建议 ---');\r\n        console.log('1. 将Background节点Layer改为UI_2D (33554432)');\r\n        console.log('2. 或者修改摄像机Visibility包含Layer 1');\r\n        console.log(`   新Visibility值应该是: ${cameraVisibility | backgroundLayer}`);\r\n    }\r\n}"]}