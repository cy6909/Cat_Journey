{"version":3,"sources":["file:///E:/work_space/wx/Cat_Journey/assets/scripts/powerups/LaserPaddlePowerUp.ts"],"names":["_decorator","Prefab","instantiate","input","Input","PowerUp","ccclass","property","LaserPaddlePowerUp","_paddleNode","_canFire","activateEffect","gameManager","getGameManager","node","getChildByName","on","EventType","TOUCH_START","onTouchStart","MOUSE_DOWN","onMouseDown","console","log","deactivateEffect","off","event","fireLaser","laserPrefab","laser","paddlePos","position","setPosition","x","y","z","addChild","laserScript","getComponent","setDamage","laserDamage","scheduleOnce","fireRate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAkBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAmBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;;AACpDC,MAAAA,O,iBAAAA,O;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;oCAGjBQ,kB,WADZF,OAAO,CAAC,oBAAD,C,UAEHC,QAAQ,CAACN,MAAD,C,2BAFb,MACaO,kBADb;AAAA;AAAA,8BACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAUpCC,WAVoC,GAUT,IAVS;AAAA,eAWpCC,QAXoC,GAWhB,IAXgB;AAAA;;AAalCC,QAAAA,cAAc,GAAS;AAC7B,gBAAMC,WAAW,GAAG,KAAKC,cAAL,EAApB;AACA,cAAI,CAACD,WAAL,EAAkB;AAElB,eAAKH,WAAL,GAAmBG,WAAW,CAACE,IAAZ,CAAiBC,cAAjB,CAAgC,QAAhC,CAAnB;AACA,cAAI,CAAC,KAAKN,WAAV,EAAuB;AAEvBN,UAAAA,KAAK,CAACa,EAAN,CAASZ,KAAK,CAACa,SAAN,CAAgBC,WAAzB,EAAsC,KAAKC,YAA3C,EAAyD,IAAzD;AACAhB,UAAAA,KAAK,CAACa,EAAN,CAASZ,KAAK,CAACa,SAAN,CAAgBG,UAAzB,EAAqC,KAAKC,WAA1C,EAAuD,IAAvD;AAEAC,UAAAA,OAAO,CAACC,GAAR,CAAY,qDAAZ;AACH;;AAESC,QAAAA,gBAAgB,GAAS;AAC/BrB,UAAAA,KAAK,CAACsB,GAAN,CAAUrB,KAAK,CAACa,SAAN,CAAgBC,WAA1B,EAAuC,KAAKC,YAA5C,EAA0D,IAA1D;AACAhB,UAAAA,KAAK,CAACsB,GAAN,CAAUrB,KAAK,CAACa,SAAN,CAAgBG,UAA1B,EAAsC,KAAKC,WAA3C,EAAwD,IAAxD;AAEAC,UAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;;AAEOJ,QAAAA,YAAY,CAACO,KAAD,EAA0B;AAC1C,eAAKC,SAAL;AACH;;AAEON,QAAAA,WAAW,CAACK,KAAD,EAAmB;AAClC,eAAKC,SAAL;AACH;;AAEOA,QAAAA,SAAS,GAAS;AACtB,cAAI,CAAC,KAAKjB,QAAN,IAAkB,CAAC,KAAKD,WAAxB,IAAuC,CAAC,KAAKmB,WAAjD,EAA8D;AAE9D,gBAAMC,KAAK,GAAG3B,WAAW,CAAC,KAAK0B,WAAN,CAAzB;AACA,gBAAME,SAAS,GAAG,KAAKrB,WAAL,CAAiBsB,QAAnC;AACAF,UAAAA,KAAK,CAACG,WAAN,CAAkBF,SAAS,CAACG,CAA5B,EAA+BH,SAAS,CAACI,CAAV,GAAc,EAA7C,EAAiDJ,SAAS,CAACK,CAA3D;AAEA,gBAAMvB,WAAW,GAAG,KAAKC,cAAL,EAApB;;AACA,cAAID,WAAJ,EAAiB;AACbA,YAAAA,WAAW,CAACE,IAAZ,CAAiBsB,QAAjB,CAA0BP,KAA1B;AACH;;AAED,gBAAMQ,WAAW,GAAGR,KAAK,CAACS,YAAN,CAAmB,OAAnB,CAApB;;AACA,cAAID,WAAJ,EAAiB;AACZA,YAAAA,WAAD,CAAqBE,SAArB,CAA+B,KAAKC,WAApC;AACH;;AAED,eAAK9B,QAAL,GAAgB,KAAhB;AACA,eAAK+B,YAAL,CAAkB,MAAM;AACpB,iBAAK/B,QAAL,GAAgB,IAAhB;AACH,WAFD,EAEG,KAAKgC,QAFR;AAGH;;AA9D2C,O;;;;;iBAER,I;;sFAEnCnC,Q;;;;;iBAC4B,C;;mFAE5BA,Q;;;;;iBACyB,G","sourcesContent":["import { _decorator, Node, Prefab, instantiate, Vec3, input, Input, EventTouch } from 'cc';\r\nimport { PowerUp } from './PowerUp';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LaserPaddlePowerUp')\r\nexport class LaserPaddlePowerUp extends PowerUp {\r\n    @property(Prefab)\r\n    public laserPrefab: Prefab | null = null;\r\n\r\n    @property\r\n    public laserDamage: number = 1;\r\n\r\n    @property\r\n    public fireRate: number = 0.5;\r\n\r\n    private _paddleNode: Node | null = null;\r\n    private _canFire: boolean = true;\r\n\r\n    protected activateEffect(): void {\r\n        const gameManager = this.getGameManager();\r\n        if (!gameManager) return;\r\n\r\n        this._paddleNode = gameManager.node.getChildByName('Paddle');\r\n        if (!this._paddleNode) return;\r\n\r\n        input.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        input.on(Input.EventType.MOUSE_DOWN, this.onMouseDown, this);\r\n\r\n        console.log('Laser Paddle activated! Touch/click to fire lasers.');\r\n    }\r\n\r\n    protected deactivateEffect(): void {\r\n        input.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        input.off(Input.EventType.MOUSE_DOWN, this.onMouseDown, this);\r\n\r\n        console.log('Laser Paddle deactivated.');\r\n    }\r\n\r\n    private onTouchStart(event: EventTouch): void {\r\n        this.fireLaser();\r\n    }\r\n\r\n    private onMouseDown(event: any): void {\r\n        this.fireLaser();\r\n    }\r\n\r\n    private fireLaser(): void {\r\n        if (!this._canFire || !this._paddleNode || !this.laserPrefab) return;\r\n\r\n        const laser = instantiate(this.laserPrefab);\r\n        const paddlePos = this._paddleNode.position;\r\n        laser.setPosition(paddlePos.x, paddlePos.y + 30, paddlePos.z);\r\n        \r\n        const gameManager = this.getGameManager();\r\n        if (gameManager) {\r\n            gameManager.node.addChild(laser);\r\n        }\r\n\r\n        const laserScript = laser.getComponent('Laser');\r\n        if (laserScript) {\r\n            (laserScript as any).setDamage(this.laserDamage);\r\n        }\r\n\r\n        this._canFire = false;\r\n        this.scheduleOnce(() => {\r\n            this._canFire = true;\r\n        }, this.fireRate);\r\n    }\r\n}"]}