{"version":3,"sources":["file:///E:/work_space/wx/Cat_Journey/assets/scripts/debug/RuntimeDebugPanel.ts"],"names":["_decorator","Component","ccclass","property","RuntimeDebugPanel","_debugPanel","_paddleController","_ball","onLoad","window","location","hostname","createDebugPanel","findGameComponents","document","createElement","style","cssText","title","innerHTML","appendChild","createSliderControl","value","_dampingFactor","undefined","console","log","toFixed","initialSpeed","_maxSpeed","body","label","id","min","max","defaultValue","step","onChanged","container","marginBottom","labelElement","slider","type","toString","addEventListener","e","parseFloat","target","valueSpan","getElementById","textContent","scheduleOnce","_findGameComponentsActual","paddleNodes","node","scene","getComponentsInChildren","length","warn","ballNodes","onDestroy","parentNode","removeChild"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n/**\r\n * Runtime Debug Panel - Linus式好品味调试工具\r\n * \r\n * 设计原则：\r\n * 1. 最简单的DOM overlay实现\r\n * 2. 直接修改组件属性，不重构架构  \r\n * 3. 只在开发环境启用\r\n * 4. 消除复杂状态，直接数据驱动\r\n */\r\n@ccclass('RuntimeDebugPanel')\r\nexport class RuntimeDebugPanel extends Component {\r\n    \r\n    private _debugPanel: HTMLElement | null = null;\r\n    private _paddleController: any = null;\r\n    private _ball: any = null;\r\n    \r\n    protected onLoad(): void {\r\n        // 只在开发环境创建调试面板\r\n        if (typeof window !== 'undefined' && window.location.hostname === 'localhost') {\r\n            this.createDebugPanel();\r\n            this.findGameComponents();\r\n        }\r\n    }\r\n    \r\n    private createDebugPanel(): void {\r\n        // 创建调试面板容器\r\n        this._debugPanel = document.createElement('div');\r\n        this._debugPanel.style.cssText = `\r\n            position: fixed;\r\n            top: 10px;\r\n            right: 10px;\r\n            width: 280px;\r\n            background: rgba(0, 0, 0, 0.8);\r\n            border: 2px solid #00ff00;\r\n            border-radius: 8px;\r\n            padding: 15px;\r\n            color: #00ff00;\r\n            font-family: monospace;\r\n            font-size: 12px;\r\n            z-index: 9999;\r\n            user-select: none;\r\n        `;\r\n        \r\n        // 标题\r\n        const title = document.createElement('div');\r\n        title.innerHTML = '🛠️ Runtime Debug Panel';\r\n        title.style.cssText = `\r\n            margin-bottom: 15px;\r\n            font-weight: bold;\r\n            text-align: center;\r\n            border-bottom: 1px solid #00ff00;\r\n            padding-bottom: 8px;\r\n        `;\r\n        this._debugPanel.appendChild(title);\r\n        \r\n        // 挡板手感控制\r\n        this.createSliderControl(\r\n            'Paddle Damping',\r\n            'paddle-damping',\r\n            0.05,\r\n            0.3,\r\n            0.15,\r\n            0.01,\r\n            (value: number) => {\r\n                if (this._paddleController && this._paddleController._dampingFactor !== undefined) {\r\n                    this._paddleController._dampingFactor = value;\r\n                    console.log(`Paddle damping set to: ${value.toFixed(3)}`);\r\n                }\r\n            }\r\n        );\r\n        \r\n        // 球速度控制\r\n        this.createSliderControl(\r\n            'Ball Speed',\r\n            'ball-speed',\r\n            50,\r\n            300,\r\n            100,\r\n            10,\r\n            (value: number) => {\r\n                if (this._ball && this._ball.initialSpeed !== undefined) {\r\n                    this._ball.initialSpeed = value;\r\n                    console.log(`Ball initial speed set to: ${value}`);\r\n                }\r\n            }\r\n        );\r\n        \r\n        // 挡板最大速度控制\r\n        this.createSliderControl(\r\n            'Paddle Max Speed',\r\n            'paddle-maxspeed',\r\n            200,\r\n            1200,\r\n            800,\r\n            50,\r\n            (value: number) => {\r\n                if (this._paddleController && this._paddleController._maxSpeed !== undefined) {\r\n                    this._paddleController._maxSpeed = value;\r\n                    console.log(`Paddle max speed set to: ${value}`);\r\n                }\r\n            }\r\n        );\r\n        \r\n        // 添加到页面\r\n        document.body.appendChild(this._debugPanel);\r\n        console.log('✅ Runtime Debug Panel created');\r\n    }\r\n    \r\n    private createSliderControl(\r\n        label: string,\r\n        id: string,\r\n        min: number,\r\n        max: number,\r\n        defaultValue: number,\r\n        step: number,\r\n        onChanged: (value: number) => void\r\n    ): void {\r\n        const container = document.createElement('div');\r\n        container.style.marginBottom = '12px';\r\n        \r\n        // 标签和数值显示\r\n        const labelElement = document.createElement('div');\r\n        labelElement.innerHTML = `${label}: <span id=\"${id}-value\">${defaultValue}</span>`;\r\n        labelElement.style.cssText = 'margin-bottom: 5px; font-weight: bold;';\r\n        \r\n        // 滑动条\r\n        const slider = document.createElement('input');\r\n        slider.type = 'range';\r\n        slider.id = id;\r\n        slider.min = min.toString();\r\n        slider.max = max.toString();\r\n        slider.step = step.toString();\r\n        slider.value = defaultValue.toString();\r\n        slider.style.cssText = `\r\n            width: 100%;\r\n            margin-bottom: 3px;\r\n            accent-color: #00ff00;\r\n        `;\r\n        \r\n        // 事件处理\r\n        slider.addEventListener('input', (e) => {\r\n            const value = parseFloat((e.target as HTMLInputElement).value);\r\n            const valueSpan = document.getElementById(`${id}-value`);\r\n            if (valueSpan) {\r\n                valueSpan.textContent = value.toString();\r\n            }\r\n            onChanged(value);\r\n        });\r\n        \r\n        container.appendChild(labelElement);\r\n        container.appendChild(slider);\r\n        this._debugPanel?.appendChild(container);\r\n    }\r\n    \r\n    private findGameComponents(): void {\r\n        // 延迟查找游戏组件，确保都已创建\r\n        this.scheduleOnce(() => {\r\n            this._findGameComponentsActual();\r\n        }, 0.2);\r\n    }\r\n    \r\n    private _findGameComponentsActual(): void {\r\n        // 查找挡板控制器\r\n        const paddleNodes = this.node.scene.getComponentsInChildren('PaddleController');\r\n        if (paddleNodes.length > 0) {\r\n            this._paddleController = paddleNodes[0];\r\n            console.log('✅ Found PaddleController for debug panel');\r\n        } else {\r\n            console.warn('❌ PaddleController not found for debug panel');\r\n        }\r\n        \r\n        // 查找球组件\r\n        const ballNodes = this.node.scene.getComponentsInChildren('Ball');\r\n        if (ballNodes.length > 0) {\r\n            this._ball = ballNodes[0];\r\n            console.log('✅ Found Ball for debug panel');\r\n        } else {\r\n            console.warn('❌ Ball not found for debug panel');\r\n        }\r\n        \r\n        // 如果组件还未找到，继续重试\r\n        if (!this._paddleController || !this._ball) {\r\n            this.scheduleOnce(() => {\r\n                this._findGameComponentsActual();\r\n            }, 1.0);\r\n        }\r\n    }\r\n    \r\n    protected onDestroy(): void {\r\n        // 清理调试面板\r\n        if (this._debugPanel && this._debugPanel.parentNode) {\r\n            this._debugPanel.parentNode.removeChild(this._debugPanel);\r\n            console.log('Debug panel cleaned up');\r\n        }\r\n    }\r\n}"]}