{"version":3,"sources":["file:///E:/work_space/wx/Cat_Journey/assets/scripts/PaddleController.ts"],"names":["_decorator","Component","input","Input","Vec3","UITransform","Canvas","ccclass","property","PaddleController","_canvasComponent","_uiTransform","_camera","onLoad","getComponent","node","parent","cameraComponent","onEnable","on","EventType","TOUCH_MOVE","onTouchMove","MOUSE_MOVE","onMouseMove","onDisable","off","event","updatePaddlePosition","getLocation","screenPos","worldPos","screenToWorld","x","y","localPos","convertToNodeSpaceAR","paddleHalfWidth","width","canvasWidth","leftBound","rightBound","clampedX","Math","max","min","setPosition","position","z"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, input, Input, EventTouch, Vec3, UITransform, Canvas, Camera, Vec2 } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PaddleController')\r\nexport class PaddleController extends Component {\r\n    @property\r\n    public moveSpeed: number = 500;\r\n\r\n    private _canvasComponent: Canvas | null = null;\r\n    private _uiTransform: UITransform | null = null;\r\n    private _camera: Camera | null = null;\r\n    \r\n    protected onLoad(): void {\r\n        this._uiTransform = this.getComponent(UITransform);\r\n        this._canvasComponent = this.node.parent?.getComponent(Canvas) || null;\r\n        this._camera = this._canvasComponent?.cameraComponent || null;\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        input.on(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        input.on(Input.EventType.MOUSE_MOVE, this.onMouseMove, this);\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        input.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        input.off(Input.EventType.MOUSE_MOVE, this.onMouseMove, this);\r\n    }\r\n\r\n    private onTouchMove(event: EventTouch): void {\r\n        this.updatePaddlePosition(event.getLocation());\r\n    }\r\n\r\n    private onMouseMove(event: any): void {\r\n        this.updatePaddlePosition(event.getLocation());\r\n    }\r\n\r\n    private updatePaddlePosition(screenPos: Vec2): void {\r\n        if (!this._camera || !this._uiTransform) return;\r\n\r\n        const worldPos = this._camera.screenToWorld(new Vec3(screenPos.x, screenPos.y, 0));\r\n        const localPos = this.node.parent?.getComponent(UITransform)?.convertToNodeSpaceAR(worldPos) || worldPos;\r\n\r\n        const paddleHalfWidth = this._uiTransform.width / 2;\r\n        const canvasWidth = this._canvasComponent?.getComponent(UITransform)?.width || 960;\r\n        const leftBound = -canvasWidth / 2 + paddleHalfWidth;\r\n        const rightBound = canvasWidth / 2 - paddleHalfWidth;\r\n\r\n        const clampedX = Math.max(leftBound, Math.min(rightBound, localPos.x));\r\n        this.node.setPosition(clampedX, this.node.position.y, this.node.position.z);\r\n    }\r\n}"]}