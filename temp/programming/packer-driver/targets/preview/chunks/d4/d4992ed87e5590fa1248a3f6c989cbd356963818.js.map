{"version":3,"sources":["file:///E:/work_space/wx/Cat_Journey/assets/scripts/powerups/Laser.ts"],"names":["_decorator","Component","RigidBody2D","Vec2","Collider2D","Contact2DType","ccclass","property","Laser","_rigidBody","onLoad","getComponent","linearVelocity","speed","collider","on","BEGIN_CONTACT","onBeginContact","scheduleOnce","node","destroy","onDestroy","off","selfCollider","otherCollider","brickScript","takeDamage","damage","name","includes","setDamage"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,a,OAAAA,a;;;;;;;;;OAC/D;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;uBAGjBQ,K,WADZF,OAAO,CAAC,OAAD,C,2BAAR,MACaE,KADb,SAC2BP,SAD3B,CACqC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOzBQ,UAPyB,GAOQ,IAPR;AAAA;;AASvBC,QAAAA,MAAM,GAAS;AACrB,eAAKD,UAAL,GAAkB,KAAKE,YAAL,CAAkBT,WAAlB,CAAlB;;AAEA,cAAI,KAAKO,UAAT,EAAqB;AACjB,iBAAKA,UAAL,CAAgBG,cAAhB,GAAiC,IAAIT,IAAJ,CAAS,CAAT,EAAY,KAAKU,KAAjB,CAAjC;AACH;;AAED,cAAMC,QAAQ,GAAG,KAAKH,YAAL,CAAkBP,UAAlB,CAAjB;;AACA,cAAIU,QAAJ,EAAc;AACVA,YAAAA,QAAQ,CAACC,EAAT,CAAYV,aAAa,CAACW,aAA1B,EAAyC,KAAKC,cAA9C,EAA8D,IAA9D;AACH;;AAED,eAAKC,YAAL,CAAkB,MAAM;AACpB,iBAAKC,IAAL,CAAUC,OAAV;AACH,WAFD,EAEG,GAFH;AAGH;;AAESC,QAAAA,SAAS,GAAS;AACxB,cAAMP,QAAQ,GAAG,KAAKH,YAAL,CAAkBP,UAAlB,CAAjB;;AACA,cAAIU,QAAJ,EAAc;AACVA,YAAAA,QAAQ,CAACQ,GAAT,CAAajB,aAAa,CAACW,aAA3B,EAA0C,KAAKC,cAA/C,EAA+D,IAA/D;AACH;AACJ;;AAEOA,QAAAA,cAAc,CAACM,YAAD,EAA2BC,aAA3B,EAA4D;AAC9E,cAAMC,WAAW,GAAGD,aAAa,CAACb,YAAd,CAA2B,OAA3B,CAApB;;AACA,cAAIc,WAAJ,EAAiB;AACZA,YAAAA,WAAD,CAAqBC,UAArB,CAAgC,KAAKC,MAArC;AACA,iBAAKR,IAAL,CAAUC,OAAV;AACH,WAHD,MAGO,IAAII,aAAa,CAACL,IAAd,CAAmBS,IAAnB,CAAwBC,QAAxB,CAAiC,MAAjC,CAAJ,EAA8C;AACjD,iBAAKV,IAAL,CAAUC,OAAV;AACH;AACJ;;AAEMU,QAAAA,SAAS,CAACH,MAAD,EAAuB;AACnC,eAAKA,MAAL,GAAcA,MAAd;AACH;;AA7CgC,O,wEAChCpB,Q;;;;;iBACsB,G;;iFAEtBA,Q;;;;;iBACuB,C","sourcesContent":["import { _decorator, Component, Node, RigidBody2D, Vec2, Collider2D, Contact2DType } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Laser')\r\nexport class Laser extends Component {\r\n    @property\r\n    public speed: number = 800;\r\n\r\n    @property\r\n    public damage: number = 1;\r\n\r\n    private _rigidBody: RigidBody2D | null = null;\r\n\r\n    protected onLoad(): void {\r\n        this._rigidBody = this.getComponent(RigidBody2D);\r\n        \r\n        if (this._rigidBody) {\r\n            this._rigidBody.linearVelocity = new Vec2(0, this.speed);\r\n        }\r\n\r\n        const collider = this.getComponent(Collider2D);\r\n        if (collider) {\r\n            collider.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n        }\r\n\r\n        this.scheduleOnce(() => {\r\n            this.node.destroy();\r\n        }, 3.0);\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n        const collider = this.getComponent(Collider2D);\r\n        if (collider) {\r\n            collider.off(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\r\n        }\r\n    }\r\n\r\n    private onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D): void {\r\n        const brickScript = otherCollider.getComponent('Brick');\r\n        if (brickScript) {\r\n            (brickScript as any).takeDamage(this.damage);\r\n            this.node.destroy();\r\n        } else if (otherCollider.node.name.includes('Wall')) {\r\n            this.node.destroy();\r\n        }\r\n    }\r\n\r\n    public setDamage(damage: number): void {\r\n        this.damage = damage;\r\n    }\r\n}"]}